/*		Copyright (C) 1987,88,89,90,91 by UCAR
 *	University Corporation for Atmospheric Research
 *		   All rights reserved
 *
 * No part of this work covered by the copyrights herein may be reproduced
 * or used in any form or by any means -- graphic, electronic, or mechanical,
 * including photocopying, recording, taping, or information storage and
 * retrieval systems -- without permission of the copyright owner.
 * 
 * This software and any accompanying written materials are provided "as is"
 * without warranty of any kind.  UCAR expressly disclaims all warranties of
 * any kind, either express or implied, including but not limited to the
 * implied warranties of merchantibility and fitness for a particular purpose.
 * UCAR does not indemnify any infringement of copyright, patent, or trademark
 * through use or modification of this software.  UCAR does not provide 
 * maintenance or updates for its software.
 */
MFVERSION="$Id: Imakefile,v 1.12 1995-01-26 21:25:35 granger Exp $"

#define IHaveSubdirs
#define PassCDebugFlags 'CDEBUGFLAGS=$(CDEBUGFLAGS)'

ETC = etc
DSLIB = ds
ZEBLIB = lib
LIBS = $(ZEBLIB) $(DSLIB)
GP = gp

#if BuildIngest && DistributeIngest
INGEST = ingest
#endif
#if BuildOptimizer && DistributeOptimizer
OPTIMIZER_DIR = Optimizer
#endif
#if BuildDataUtilities && DistributeDataUtil
DATAUTIL = datautil
#endif
#if BuildRealtimeDataStoreTools && DistributeRealtimeDataStoreTools
REALTIME = realtime
#endif   
#if BuildDataManager && DistributeDataManager
DSMANAGE = dsmanage
#endif


/*
 * "lib" and "ds" must come first, in that order.  Thereafter it's
 * alphabetical but really doesn't matter.
 */
SUBDIRS = $(LIBS) $(DATAUTIL) dm dsdelete dsdump dsprint dsdwidget \
	$(DSMANAGE) dsrescan $(ETC) EventLogger fccclock gettime \
	$(GP) $(INGEST) msg msg_ping mstatus mtap $(OPTIMIZER_DIR) \
	pdmon prt_Notify $(REALTIME) settime Sound timer tweakcolor \
	xhelp zstop zmon zquery zrun zstart

DSCLIENTS = $(LIBS) dsdelete dsdump dsprint dsdwidget $(DSMANAGE) \
	dsrescan $(GP) $(INGEST) $(OPTIMIZER_DIR) $(REALTIME)

DSUTILS = $(LIBS) dsdelete dsdump dsprint dsdwidget $(DSMANAGE) \
	dsrescan $(REALTIME)

MSGUTILS = $(ZEBLIB) msg msg_ping mstatus mtap zebstop zmon zquery zrun

XCOMM Include everything in the distfiles target.  They
XCOMM don't all have to be compiled, so no big deal sending along a little
XCOMM extra source.  Distribute prt_Notify even though it will never get
XCOMM built, so that we don't forget it somewhere down the road.

#if DistributeIngest
DISTINGEST = ingest
#endif
#if DistributeOptimzer
DISTOPTIMIZER = Optimizer
#endif
#if DistributeDataUtil
DISTDATAUTIL = datautil
#endif
#if DistributeRealtimeDataStoreTools
DISTREALTIME = realtime
#endif
#if DistributeDataManager
DISTDSMANAGE = dsmanage
#endif

DISTFILES = Imakefile
DISTSUBDIRS = lib ds $(DISTDATAUTIL) dm dsdelete dsdump dsprint \
	dsdwidget $(DISTDSMANAGE) dsrescan etc EventLogger fccclock \
	gettime $(GP) $(DISTINGEST) msg msg_ping mstatus mtap \
	$(DISTOPTIMIZER) pdmon prt_Notify $(DISTREALTIME) settime \
	Sound timer tweakcolor xhelp zebstop zmon zquery zrun

MakeSubdirs($(SUBDIRS))
DependSubdirs($(SUBDIRS))
InstallLibSubdirs($(SUBDIRS))
DistfilesTarget($(DISTFILES))
DistfilesSubdirs($(DISTSUBDIRS))

TARGET = all

programs:
	$(MAKE) $(MFLAGS) ETC= LIBS= GP='$(GP)' $(TARGET)

libraries:
	$(MAKE) $(MFLAGS) SUBDIRS='$(LIBS)' $(TARGET)

dsclients:
	$(MAKE) $(MFLAGS) SUBDIRS='$(DSCLIENTS)' GP='$(GP)' LIBS='$(LIBS)' \
		$(TARGET)

dsutils:
	$(MAKE) $(MFLAGS) SUBDIRS='$(DSUTILS)' LIBS='$(LIBS)' $(TARGET)

msgutils:
	$(MAKE) $(MFLAGS) SUBDIRS='$(MSGUTILS)' ZEBLIB='$(ZEBLIB)' $(TARGET)

#if !BuildIngest
OmitBuildRules(ingest utilities)
#endif

#if !BuildOptimizer
OmitBuildRules(Optimizer)
#endif

#if !BuildDataUtilities
OmitBuildRules(data utilities)
#endif

#if !BuildRealtimeDataStoreTools
OmitBuildRules(real-time DataStore tools)
#endif   

#if !BuildDataManager
OmitBuildRules(dsmanage)
#endif
