/*
 * Imakefile for the zeb library.
 */
/*		Copyright (C) 1987,88,89,90,91,92 by UCAR
 *	University Corporation for Atmospheric Research
 *		   All rights reserved
 *
 * No part of this work covered by the copyrights herein may be reproduced
 * or used in any form or by any means -- graphic, electronic, or mechanical,
 * including photocopying, recording, taping, or information storage and
 * retrieval systems -- without permission of the copyright owner.
 * 
 * This software and any accompanying written materials are provided "as is"
 * without warranty of any kind.  UCAR expressly disclaims all warranties of
 * any kind, either express or implied, including but not limited to the
 * implied warranties of merchantibility and fitness for a particular purpose.
 * UCAR does not indemnify any infringement of copyright, patent, or trademark
 * through use or modification of this software.  UCAR does not provide 
 * maintenance or updates for its software.
 */
/* $Id: Imakefile,v 1.18 1996-06-21 16:24:29 granger Exp $ */

#if !HasWritev
WRITEVOBJ=writev.o
WRITEVSRC=writev.c
#else
WRITEVOBJ=
WRITEVSRC=
#endif

/*
 * Graphics widget needs to know whether to try shared memory, and the
 * ConfigVars routines need to the various default directory paths.
 */
DEPEND_DEFINES = $(SHMDEFINES) $(DIRDEFINES)

TESTSRCS = cvt_test.c re_test.c msg_test.c

SRCS = alarmwidget.c altunits.c barb.c Bitmaps.c cmd_proto.c cmd_exec.c \
	ConfigVars.c convert.c GraphicsW.c ImageXfr.c Buttons.c \
	msg_BCast.c msg_lib.c netread.c Parse.c pdlib.c pdretrv.c pdaux.c \
	RLEncode.c Sound_lib.c TCvt.c TInterp.c timer_lib.c twidget.c \
	vector.c $(WRITEVSRC) FindFile.c zl_regex.c dm_lib.c $(TESTSRCS) \
	location.c

OBJS = alarmwidget.o altunits.o barb.o Bitmaps.o cmd_proto.o cmd_exec.o \
	ConfigVars.o convert.o GraphicsW.o ImageXfr.o Buttons.o \
	msg_BCast.o msg_lib.o netread.o Parse.o pdlib.o pdretrv.o pdaux.o \
	RLEncode.o Sound_lib.o TCvt.o TInterp.o timer_lib.o twidget.o \
	vector.o $(WRITEVOBJ) FindFile.o zl_regex.o dm_lib.o \
	location.o

TESTOBJS = cvt_test.o re_test.o msg_test.o

HEADERS = bitmaps.h copyright.h defs.h GraphicsW.h GraphicsWP.h message.h \
	pd.h timer.h ImageXfr.h zl_regex.h dm.h twidget.h byteorder.h \
	draw.h

DISTFILES = $(SRCS) writev.c $(HEADERS) Imakefile

NormalLibraryTarget (Zeb, $(OBJS))

SpecialObjectRule(GraphicsW.o,/**/,$(SHMDEFINES))
SpecialObjectRule(ConfigVars.o,/**/,$(DIRDEFINES))

InstallLibrary (Zeb, $(LIBDIR))

BuildIncludesTop ($(HEADERS))
InstallMultipleFlags($(HEADERS),$(INCDIR),$(INSTINCFLAGS))

DependTarget()

LintTarget()

MSGOBJS = msg_lib.o netread.o
CVTOBJS = cvt_test.o convert.o

TestProgramTarget(cvt_test,$(CVTOBJS) $(MSGOBJS),/**/,/**/,$(LIBMATH))

TestProgramTarget(re_test, re_test.o zl_regex.o,/**/,/**/,$(LIBREGEXP))

TestProgramTarget(msg_test, msg_test.o $(MSGOBJS),/**/,/**/,/**/)

RunTestProgram(cvt_test,coordinate conversion,cvt_test)
RunTestProgram(msg_test,error logging,msg_test > /dev/null 2>&1)
RunTestProgram(re_test,regular expressions,re_test)

DistfilesTarget($(DISTFILES))
