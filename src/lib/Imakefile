/*
 * Imakefile for the zeb library.
 */
/*		Copyright (C) 1987,88,89,90,91,92 by UCAR
 *	University Corporation for Atmospheric Research
 *		   All rights reserved
 *
 * No part of this work covered by the copyrights herein may be reproduced
 * or used in any form or by any means -- graphic, electronic, or mechanical,
 * including photocopying, recording, taping, or information storage and
 * retrieval systems -- without permission of the copyright owner.
 * 
 * This software and any accompanying written materials are provided "as is"
 * without warranty of any kind.  UCAR expressly disclaims all warranties of
 * any kind, either express or implied, including but not limited to the
 * implied warranties of merchantibility and fitness for a particular purpose.
 * UCAR does not indemnify any infringement of copyright, patent, or trademark
 * through use or modification of this software.  UCAR does not provide 
 * maintenance or updates for its software.
 */

#if !HasWritev
WRITEVOBJ=writev.o
WRITEVSRC=writev.c
#else
WRITEVOBJ=
WRITEVSRC=
#endif

/*
 * Graphics widget needs to know whether to try shared memory, and the
 * ConfigVars routines need to the various default directory paths.
 */
DEFINES = $(SHMDEFINES) $(DIRDEFINES)

SRCS = alarmwidget.c altunits.c barb.c Bitmaps.c cmd_proto.c cmd_exec.c \
	ConfigVars.c convert.c GraphicsW.c ImageXfr.c Buttons.c \
	msg_BCast.c msg_lib.c netread.c Parse.c pdlib.c pdretrv.c pdaux.c \
	RLEncode.c Sound_lib.c TCvt.c TInterp.c timer_lib.c twidget.c \
	vector.c $(WRITEVSRC) FindFile.c zl_regex.c dm_lib.c

OBJS = alarmwidget.o altunits.o barb.o Bitmaps.o cmd_proto.o cmd_exec.o \
	ConfigVars.o convert.o GraphicsW.o ImageXfr.o Buttons.o \
	msg_BCast.o msg_lib.o netread.o Parse.o pdlib.o pdretrv.o pdaux.o \
	RLEncode.o Sound_lib.o TCvt.o TInterp.o timer_lib.o twidget.o \
	vector.o $(WRITEVOBJ) FindFile.o zl_regex.o dm_lib.o

HEADERS = bitmaps.h copyright.h defs.h GraphicsW.h GraphicsWP.h message.h \
	pd.h timer.h ImageXfr.h zl_regex.h dm.h twidget.h

DISTFILES = $(SRCS) writev.c $(HEADERS) Imakefile

NormalLibraryTarget (Zeb, $(OBJS))

InstallLibrary (Zeb, $(LIBDIR))

BuildIncludes ($(HEADERS),.,.)

DependTarget()

LintTarget()

/*
 * Hard-coded targets for testing library objects
 */
tconvert: tconvert.c convert.o $(DEPLIBS)
	$(RM) $@
	$(CC) -o $@ $(ALLDEFINES) tconvert.c convert.o $(LDOPTIONS) \
	$(LIBZEB) $(LIBRDSS) $(XLIBS) $(LDLIBS) $(SYSLIBS) $(EXTRA_LOAD_FLAGS)

clean::
	$(RM) tconvert

re_test: re_test.o zl_regex.o
	$(RM) $@
	$(CC) -o $@ $(ALLDEFINES) re_test.o zl_regex.o $(LDOPTIONS) \
			$(LDLIBS) $(SYSLIBS) $(EXTRA_LOAD_FLAGS)

clean::
	$(RM) re_test

msg_test: msg_test.o msg_lib.o netread.o
	$(RM) $@
	$(CC) -o $@ $(ALLDEFINES) msg_test.o msg_lib.o netread.o \
	   $(LDOPTIONS) $(LDLIBS) $(SYSLIBS) $(EXTRA_LOAD_FLAGS)

clean::
	$(RM) msg_test

DistfilesTarget($(DISTFILES))
