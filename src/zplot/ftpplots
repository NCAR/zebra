#! /usr/local/bin/perl5
#
# FTP images to a remote host
# $Id: ftpplots,v 1.7 1999-10-15 19:09:28 granger Exp $

$site="$ENV{'PLOT_FTP_HOST'}";
$dir="$ENV{'PLOT_FTP_DIR'}";
$user="anonymous";
$pass="iss\@atd.ucar.edu";

$error=0;

if ($#ARGV < 0)
{
    print "No files to transmit\n";
    exit 0;
}

require ("ftplib.pl");

&ftp::open($site,$user,$pass) || die;
&ftp::binary;
TRY:
{
    # print join("\n",&ftp::dir());

    if (! &ftp::cwd($dir))
    {
	print "CWD $dir failed: $!";
	++$error;
	last TRY;
    }

    print &ftp::pwd(), "\n";
    foreach $local (@ARGV)
    {
	$remote = $local;
	$remote =~ s,.*/,,g;
	print "Putting $local to $remote...";
	if (! &ftp::put ($local,$remote))
	{
	    print "$ftp::Error\n";
	    ++$error;
	    # last TRY;
	}
	print "\n";
    }

}

&ftp::close;
exit $error;

__END__

    # Now remove it, since this is just a test
    foreach $local (@ARGV)
    {
	$remote = $local;
	$remote =~ s,.*/,,g;
	print "Removing $remote...";
	if (! &ftp::delete ($remote))
	{
	    print "Delete failed for $f: $!";
	}
	print "\n";
    }
    
