#! /usr/local/bin/perl5
#
# FTP images to JOSS
# $Id: ftpplots,v 1.5 1998-01-22 17:52:14 granger Exp $

$site="ftp.joss.ucar.edu";
$user="anonymous";
$pass="granger\@ucar.edu";
$dir="/pub/incoming/lakeice";

#$site="fog.personal.engin.umich.edu";
#$user="anonymous";
#$pass="granger\@ucar.edu";
#$dir="/pub/lakeice";

$error=0;

if ($#ARGV < 0)
{
    print "No files to transmit\n";
    exit 0;
}

require ("ftplib.pl");

&ftp::open($site,$user,$pass) || die;
&ftp::binary;
TRY:
{
    # print join("\n",&ftp::dir());

    if (! &ftp::cwd($dir))
    {
	print "CWD $dir failed: $!";
	++$error;
	last TRY;
    }

    print &ftp::pwd(), "\n";
    foreach $local (@ARGV)
    {
	$remote = $local;
	$remote =~ s,.*/,,g;
	print "Putting $local to $remote...";
	if (! &ftp::put ($local,$remote))
	{
	    print "$ftp::Error\n";
	    ++$error;
	    # last TRY;
	}
	print "\n";
    }

}

&ftp::close;
exit $error;

__END__

    # Now remove it, since this is just a test
    foreach $local (@ARGV)
    {
	$remote = $local;
	$remote =~ s,.*/,,g;
	print "Removing $remote...";
	if (! &ftp::delete ($remote))
	{
	    print "Delete failed for $f: $!";
	}
	print "\n";
    }
    
